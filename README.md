# Vertex AI Search Proxy

A FastAPI application that provides a search proxy interface for Google Cloud's Vertex AI Search service. This proxy integrates with Google Cloud Storage to provide enhanced search results, including:

* Summaries: Concise summaries of search results generated by Vertex AI.
* Snippets: Relevant text snippets extracted from search results.
* Extractive Answers: Direct, factual answers to your queries (if enabled).
* Extractive Segments: Highly relevant sections of text within search results (if enabled).
* Metadata: Additional metadata sourced from Google Cloud Storage for each search result.

## Key Features:

* Easy Integration: Provides a RESTful API endpoint for interacting with Vertex AI Search.
* Enhanced Search Results: Delivers richer search results with summaries, snippets, extractive answers/segments (optional), and metadata.
* Security: Built-in API key authentication.

## Requirements

* Python 3.7 +
* A Google Cloud Project with the following:
    * Vertex AI Search service enabled
    * A Vertex AI data store populated with documents
    * A Google Cloud Storage bucket to store metadata (optional)
* Environment variables set up (see Setup below)
* Packages listed in `requirements.txt`

## Setup

1. Install dependencies:
``` bash
pip install -r requirements.txt
```
2. Environment Variables:
Export the following environment variables:

`API_KEY`: Your desired API key for authentication.
`GOOGLE_CLOUD_PROJECT`: Your Google Cloud project ID.
`DATA_STORE_LOCATION`: Region or global (for global data stores).
`DATA_STORE_ID`: ID of your existing Vertex AI data store.
`ENABLE_EXTRACTIVE_ANSWERS`: (Optional) Set to true to enable extractive answers.
`ENABLE_EXTRACTIVE_SEGMENTS`: (Optional) Set to true to enable extractive segments.
`PORT`: The port where you want to run the server (default: 8000).

## Usage

1. Start the Server:
``` bash
uvicorn app:app --reload
```
2. Send Search Queries:
``` bash
curl -X POST http://localhost:8000/ -H 'X-API-Key: YOUR_API_KEY' \
     -d '{"query": "your search query here" }'
```
Replace `YOUR_API_KEY` with your actual API key.

## Example Response

``` JSON
{
  "summary": "A short summary of the search results...",
  "documents": [
    {
      "title": "Document Title",
      "link": "gs://your-bucket/document.pdf",
      "snippets": ["Relevant snippet ..."],
      "extractive_answers": [
         {
           "content": "Direct answer to the query...",
           "page_number": 2
         }
       ],
      "extractive_segments": [
        {
          "content":  "Highly relevant segment of text...",
          "page_number": 1
        }
      ],
      "metadata": [
        { "key": "author", "value": "John Doe" }, 
        { "key": "date", "value": "2024-02-22"}
      ] 
    },
    ... 
  ]
}
```
## Disclaimer

This project is intended as a tool for developers. It's essential to ensure the Vertex AI Search service is configured correctly and your data store is populated appropriately for optimal results.
